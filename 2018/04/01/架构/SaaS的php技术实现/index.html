<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SaaS的php技术实现 | MARTIST</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="对我们phper来讲，这些概念不难理解">
<meta name="keywords" content="php,web">
<meta property="og:type" content="article">
<meta property="og:title" content="SaaS的php技术实现">
<meta property="og:url" content="http://martist.cn/2018/04/01/架构/SaaS的php技术实现/index.html">
<meta property="og:site_name" content="MARTIST">
<meta property="og:description" content="对我们phper来讲，这些概念不难理解">
<meta property="og:locale" content="简体中文">
<meta property="og:updated_time" content="2018-08-15T12:50:35.205Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SaaS的php技术实现">
<meta name="twitter:description" content="对我们phper来讲，这些概念不难理解">
  
    <link rel="alternate" href="/atom.xml" title="MARTIST" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://martist.cn"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/2012/01/01/About Me/">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">MARTIST</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-架构/SaaS的php技术实现" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/01/架构/SaaS的php技术实现/" class="article-date">
  <time datetime="2018-03-31T16:00:00.000Z" itemprop="datePublished">2018-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SaaS的php技术实现
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>：-} <a id="more"></a></p>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="SOFTWARE-AS-A-SERVICE"><a href="#SOFTWARE-AS-A-SERVICE" class="headerlink" title="SOFTWARE AS A SERVICE"></a>SOFTWARE AS A SERVICE</h3><p>在某些方面，SaaS非常类似于早些年的瘦客户端软件模式，其中客户端（在这种情况下通常是Web浏览器）提供对服务器上运行的软件的访问点。 SaaS是消费者最熟悉的云服务形式。 SaaS将管理软件及其部署的任务转移到第三方服务。最熟悉的业务SaaS应用程序是客户关系管理应用程序，如Salesforce，像Google Apps这样的生产力软件，以及Box和Dropbox等存储解决方案的软件。</p>
<p>使用SaaS应用程序往往会降低软件所有权成本，因为不需要技术人员来管理软件的安装，管理和升级，同时这也可以降低软件许可的成本。SaaS应用程序通常在订阅模式上被提出来。</p>
<h3 id="PLATFORM-AS-A-SERVICE"><a href="#PLATFORM-AS-A-SERVICE" class="headerlink" title="PLATFORM AS A SERVICE"></a>PLATFORM AS A SERVICE</h3><p>PaaS提供比SaaS低一级的功能，通常提供可以开发和部署软件的平台。 PaaS提供者抽象处理服务器的大部分工作，并为客户提供了操作系统和服务器软件以及底层服务器硬件和网络基础设施的环境，使用户可以自由地关注业务端可扩展性及其产品或服务的应用开发。</p>
<p>与大多数云服务一样，PaaS是建立在虚拟化技术之上的。企业可以根据需要申请资源，随着需求的增长而不是以冗余资源投入硬件。</p>
<p>PaaS提供商的例子包括Heroku，Google App Engine和Red Hat的OpenShift。</p>
<h3 id="INFRASTRUCTURE-AS-A-SERVICE"><a href="#INFRASTRUCTURE-AS-A-SERVICE" class="headerlink" title="INFRASTRUCTURE AS A SERVICE"></a>INFRASTRUCTURE AS A SERVICE</h3><p>继续朝服务的下层看，我们就可以看到云服务的基本构件。 IaaS由高度自动化和可扩展的计算资源组成，由云存储和可以自动配置，计量和可用的按需网络功能组成。</p>
<p>IaaS提供商通过仪表板以及API（API可能没有）提供这些云服务器及其相关资源。 IaaS客户可以直接访问其服务器和存储，就像传统服务器一样，但这样拥有更高级别的可扩展性。 IaaS的用户可以在云中外包和构建“虚拟数据中心”，并可以访问许多与传统数据中心相同的技术和资源功能，而无需投资于服务器容量规划或物理管理维护。</p>
<p>IaaS是最灵活的云计算模式，允许自动的服务器，处理能力，存储和网络的自动部署。 IaaS客户对基础设施拥有真正的控制，比PaaS或SaaS服务的用户不知道高到哪里去了。 IaaS的主要用途包括PaaS，SaaS和网络规模应用程序的实际开发和部署。</p>
<p>有很多提供商提供Iaas，比如Navisite，Exoscale和Softlayer，具有自己独特的价格方案和服务组合可供选择。</p>
<p>ComputeNext（作者的网站）为IaaS提供一个经纪服务，以便你可以确保为您的应用需求选择合适的IaaS提供商。通过使用单一API对20多个云提供商进行归一化的访问，您可以比较提供商的价格和性能，从而找到最佳配置，然后构建和部署，而不会被绑死到一个平台。</p>
<p>具体例子可以参考：<a href="https://www.zhihu.com/question/21641778/answer/95652959" target="_blank" rel="external">https://www.zhihu.com/question/21641778/answer/95652959</a></p>
<h3 id="通俗的讲pass和saas的区别"><a href="#通俗的讲pass和saas的区别" class="headerlink" title="通俗的讲pass和saas的区别"></a>通俗的讲pass和saas的区别</h3><p>paas给你一个完善的开发，测试，上线的环境，应用工程代码还是需要你来开发，在开发过程需要的一些服务已经帮你做好，比如：短信服务，邮件服务，分布式文件系统服务，域名备案服务，网络端负载均衡服务，数据库端负载主从热备服务，分片服务，vpn服务，https服务，各个线上服务器的监控统计服务等；saas是应用工程帮你做好，你只需要调整下页面配置，即可上线运营，有点类似淘宝平台与淘宝入驻商家之间的关系。</p>
<h2 id="程序设计"><a href="#程序设计" class="headerlink" title="程序设计"></a>程序设计</h2><h3 id="分层设计"><a href="#分层设计" class="headerlink" title="分层设计"></a>分层设计</h3><p>saas系统分层大概是：  </p>
<blockquote>
<p>租户识别&gt;应用层&gt;数据访问层&gt;缓存层&gt;数据库  </p>
</blockquote>
<p>业务代码都是写在应用层。<br>租户识别可以用spring拦截器实现，然后使用ThreadLocal传递给后端<br>数据库和缓存层对应用层应该是透明的。程序员在写代码的时候，只关心业务逻辑，不应该担心多租户的问题。</p>
<h3 id="数据隔离"><a href="#数据隔离" class="headerlink" title="数据隔离"></a>数据隔离</h3><p>saas系统说起来很简单，任何系统似乎加个tenant_id(租户id)就变成saas系统了。比如原来的用户登录是：</p>
<pre><code>select username,password from users where email=&apos;abc@qq.com&apos;
</code></pre><p>改成</p>
<pre><code>select username,password from users where email=&apos;abc@qq.com&apos; and tenant_id =1;
</code></pre><p>对于复杂业务的saas系统，这样做法非常危险，而且开发效率很低。你想想如果那个程序员写sql时候忘了加 “ and tenant_id =1” . 结果不堪设想。<br>比较好做法是在数据库访问层对SQL进行改写。</p>
<pre><code>TenantContext.exec(&quot;select username,password from users where email=&apos;abc@qq.com&apos; &quot;);
</code></pre><p>在连接池根据TenatnContext改写Sql.<br>这样做好处是，一来程序猿最多把系统搞down了，也不至于信息串了互相泄露。二来将来做分表分库也很方便，上层应用不用修改。</p>
<h3 id="租户识别方案"><a href="#租户识别方案" class="headerlink" title="租户识别方案"></a>租户识别方案</h3><p>比较好做法是通过url识别租户。系统是给租户生成一个随机的三级域名，比如 abc.crm.baidu.com.   如果客户想使用自己的域名，可以在cname到我们生成的三级域名，并在管理系统里面做绑定。<br>这样一个租户可以有两个域名，访问saas,一个随机生成的三级域名，另外一个租户自己的域名.代码里面可以根据过来的域名，判断是那个租户然后初始化TenantContext.<br>如果不想通过域名来做，也可以通过登录名来判断。这种方式要涉及到租户切换问题。</p>
<h3 id="租户管理系统（计费，订购，定制，充值，催缴）"><a href="#租户管理系统（计费，订购，定制，充值，催缴）" class="headerlink" title="租户管理系统（计费，订购，定制，充值，催缴）"></a>租户管理系统（计费，订购，定制，充值，催缴）</h3><p>Saas系统是必须考虑计费系统和租户控制系统。这个系统需要都是独立设计。比如那个租户购买了那些模块，一个月多少钱。租户可以创建最多的用户数。计费到期邮件提醒等功能。<br>计费方式一般有两种，周期性计费，类似月租方案，和使用量计费,用多少付多少。 周期性计费比较简单。也可以两者结合起来。</p>
<h3 id="定制化开发"><a href="#定制化开发" class="headerlink" title="定制化开发"></a>定制化开发</h3><p>SAAS的优势在于一套系统多人使用，似乎和定制化开发有冲突。比如A客户想要A功能，B客户不想要。但定制化开发是无法避免的，比如CRM系统这样复杂的系统，不可能一套系统满足所有公司的要求。定制化开发尽可能分系统，分模块去做。然后通过控制台中配置不同租户订购不同模块，那些模块可以在前端页面上显示。不同的子系统需要分开部署。前端可通过nginx根据url分发，比如 abc.crm.baidu.com/bi/xxx/xx这个地址，就分发到BI子系统。不要尝试OSGI去搞模块化，这个是个大坑。<br>还有开发和产品，现有需求一定要分析清楚，不要一上线发现后患无穷。新功能尽量做的独立可以配置。</p>
<h3 id="灰度升级"><a href="#灰度升级" class="headerlink" title="灰度升级"></a>灰度升级</h3><p>SAAS付费企业客户对系统问题都特别敏感。 为了减少升级可能出现问题的影响范围，一般都采用灰度升级策略。如果使用了url来区分不同租户，灰度升级配置就会很方便。可以配置nginx 来根据域名做分发，比如租户A（aaa.com）到实例1（版本1.0），租户B(bbb.com)到实例2(版本). 当需要域名配置非常多的时候，nginx配置文档会乱。这块时候可以考虑使用nignx_lua来写一些扩展模块。</p>
<h2 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a>技术实现</h2><h3 id="关于多租户的数据隔离方案"><a href="#关于多租户的数据隔离方案" class="headerlink" title="关于多租户的数据隔离方案"></a>关于多租户的数据隔离方案</h3><h4 id="独立数据库"><a href="#独立数据库" class="headerlink" title="独立数据库"></a>独立数据库</h4><p>这是第一种方案，即一个租户一个数据库，这种方案的用户数据隔离级别最高，安全性最好，但成本较高。<br>优点：<br>为不同的租户提供独立的数据库，有助于简化数据模型的扩展设计，满足不同租户的独特需求；如果出现故障，恢复数据比较简单。<br>缺点：<br>增多了数据库的安装数量，随之带来维护成本和购置成本的增加。<br>这种方案与传统的一个客户、一套数据、一套部署类似，差别只在于软件统一部署在运营商那里。如果面对的是银行、医院等需要非常高数据隔离级别的租户，可以选择这种模式，提高租用的定价。如果定价较低，产品走低价路线，这种方案一般对运营商来说是无法承受的。</p>
<h4 id="共享数据库，隔离数据架构"><a href="#共享数据库，隔离数据架构" class="headerlink" title="共享数据库，隔离数据架构"></a>共享数据库，隔离数据架构</h4><p>这是第二种方案，即多个或所有租户共享Database，但是每个租户一个Schema（也可叫做一个user）。<br>优点：<br>为安全性要求较高的租户提供了一定程度的逻辑数据隔离，并不是完全隔离；每个数据库可支持更多的租户数量。<br>缺点：<br>如果出现故障，数据恢复比较困难，因为恢复数据库将牵涉到其他租户的数据；<br>如果需要跨租户统计数据，存在一定困难。</p>
<h4 id="共享数据库，共享数据架构"><a href="#共享数据库，共享数据架构" class="headerlink" title="共享数据库，共享数据架构"></a>共享数据库，共享数据架构</h4><p>这是第三种方案，即租户共享同一个Database、同一个Schema，但在表中增加TenantID多租户的数据字段。这是共享程度最高、隔离级别最低的模式。<br>优点：<br>三种方案比较，第三种方案的维护和购置成本最低，允许每个数据库支持的租户数量最多。<br>缺点：<br>隔离级别最低，安全性最低，需要在设计开发时加大对安全的开发量；<br>数据备份和恢复最困难，需要逐表逐条备份和还原。<br>如果希望以最少的服务器为最多的租户提供服务，并且租户接受牺牲隔离级别换取降低成本，这种方案最适合。</p>
<h3 id="选择合理的实现模式"><a href="#选择合理的实现模式" class="headerlink" title="选择合理的实现模式"></a>选择合理的实现模式</h3><p>衡量三种模式主要考虑的因素是隔离还是共享。</p>
<h4 id="成本角度因素"><a href="#成本角度因素" class="headerlink" title="成本角度因素"></a>成本角度因素</h4><p>隔离性越好，设计和实现的难度和成本越高，初始成本越高。共享性越好，同一运营成本下支持的用户越多，运营成本越低。</p>
<h4 id="安全因素"><a href="#安全因素" class="headerlink" title="安全因素"></a>安全因素</h4><p>要考虑业务和客户的安全方面的要求。安全性要求越高，越要倾向于隔离。</p>
<h4 id="租户数量因素"><a href="#租户数量因素" class="headerlink" title="租户数量因素"></a>租户数量因素</h4><p>系统要支持多少租户？上百？上千还是上万？可能的租户越多，越倾向于共享。<br>平均每个租户要存储数据需要的空间大小。存贮的数据越多，越倾向于隔离。<br>每个租户的同时访问系统的最终用户数量。需要支持的越多，越倾向于隔离。<br>是否想针对每一租户提供附加的服务，例如数据的备份和恢复等。这方面的需求越多， 越倾向于隔离。</p>
<h4 id="信息监管因素"><a href="#信息监管因素" class="headerlink" title="信息监管因素"></a>信息监管因素</h4><p>要考虑政府，机关，企业，公司的安全和信息监管相关的一些政策和规定。</p>
<h3 id="基于laravel框架开发SaaS系统"><a href="#基于laravel框架开发SaaS系统" class="headerlink" title="基于laravel框架开发SaaS系统"></a>基于laravel框架开发SaaS系统</h3><ol>
<li>利用laravel内置的前置中间件对租户请求域名进行判断，进而区分租户。</li>
<li>每个租户的密钥来对应请求域名，后端鉴权通过每个租户不同的密钥和请求域名来制造签名，中心API服务器以此鉴权。实现ACL，防止数据遭窃。</li>
<li>分库分表，实现数据隔离，可以使分库作为本公司master数据库的一个备库扩展库，从而实现读写分离，数据安全，查询优化等功能。</li>
<li>为saas用户提供服务器前端项目，不提供数据链接，服务器前端项目为可转发请求的服务治理中间件功能的框架（curl，guzzle），租户可以买账号直接使用系统，也可以搭在自己服务器，自行增减配置运维，写前端代码添加个性化的内容比如商标、首页、详情页等等。后端接口维护在本公司的服务器，如果系统有bug可以随时处理而不需要去所有租户的服务器重新部署，实现平滑升级。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://martist.cn/2018/04/01/架构/SaaS的php技术实现/" data-id="cjtcpn6ge00cdy16ujt7n3ty3" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li></ul>

    </footer>
  </div>
  
    
    
<nav id="article-nav">
  
    <a href="/2018/04/08/面试系列/面试系列之PHP弱类型的底层实现/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          面试系列之PHP弱类型的底层实现
        
      </div>
    </a>
  
  
    <a href="/2018/03/20/架构/简单谈接口设计/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">简单谈接口设计</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
            <div id="SOHUCS" sid="2018/04/01/架构/SaaS的php技术实现/"> </div>
    
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">Content</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概念"><span class="toc-number">1.</span> <span class="toc-text">概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SOFTWARE-AS-A-SERVICE"><span class="toc-number">1.1.</span> <span class="toc-text">SOFTWARE AS A SERVICE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PLATFORM-AS-A-SERVICE"><span class="toc-number">1.2.</span> <span class="toc-text">PLATFORM AS A SERVICE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INFRASTRUCTURE-AS-A-SERVICE"><span class="toc-number">1.3.</span> <span class="toc-text">INFRASTRUCTURE AS A SERVICE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通俗的讲pass和saas的区别"><span class="toc-number">1.4.</span> <span class="toc-text">通俗的讲pass和saas的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#程序设计"><span class="toc-number">2.</span> <span class="toc-text">程序设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分层设计"><span class="toc-number">2.1.</span> <span class="toc-text">分层设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据隔离"><span class="toc-number">2.2.</span> <span class="toc-text">数据隔离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#租户识别方案"><span class="toc-number">2.3.</span> <span class="toc-text">租户识别方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#租户管理系统（计费，订购，定制，充值，催缴）"><span class="toc-number">2.4.</span> <span class="toc-text">租户管理系统（计费，订购，定制，充值，催缴）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#定制化开发"><span class="toc-number">2.5.</span> <span class="toc-text">定制化开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#灰度升级"><span class="toc-number">2.6.</span> <span class="toc-text">灰度升级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#技术实现"><span class="toc-number">3.</span> <span class="toc-text">技术实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关于多租户的数据隔离方案"><span class="toc-number">3.1.</span> <span class="toc-text">关于多租户的数据隔离方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#独立数据库"><span class="toc-number">3.1.1.</span> <span class="toc-text">独立数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#共享数据库，隔离数据架构"><span class="toc-number">3.1.2.</span> <span class="toc-text">共享数据库，隔离数据架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#共享数据库，共享数据架构"><span class="toc-number">3.1.3.</span> <span class="toc-text">共享数据库，共享数据架构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#选择合理的实现模式"><span class="toc-number">3.2.</span> <span class="toc-text">选择合理的实现模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#成本角度因素"><span class="toc-number">3.2.1.</span> <span class="toc-text">成本角度因素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安全因素"><span class="toc-number">3.2.2.</span> <span class="toc-text">安全因素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#租户数量因素"><span class="toc-number">3.2.3.</span> <span class="toc-text">租户数量因素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#信息监管因素"><span class="toc-number">3.2.4.</span> <span class="toc-text">信息监管因素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于laravel框架开发SaaS系统"><span class="toc-number">3.3.</span> <span class="toc-text">基于laravel框架开发SaaS系统</span></a></li></ol></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2019 马闯&nbsp;|&nbsp;
      Theme by <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      Contact&nbsp;|&nbsp;marteeet@gmail.com
    </div>
  </div>
</footer>
 <script src="/jquery/jquery.min.js"></script>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/2012/01/01/About Me/" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      



<script type="text/javascript ">
    (function () {
        var appid = 'cytf1deXv';
        var conf = '6867419241543404b6c287f39f49f3ca';
        var width = window.innerWidth || document.documentElement.clientWidth;
        if (width < 960) {
            window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>');
        } else {
            var loadJs = function (d, a) {
                var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
                var b = document.createElement("script");
                b.setAttribute("type", "text/javascript");
                b.setAttribute("charset", "UTF-8");
                b.setAttribute("src", d);
                if (typeof a === "function") {
                    if (window.attachEvent) {
                        b.onreadystatechange = function () {
                            var e = b.readyState;
                            if (e === "loaded" || e === "complete") {
                                b.onreadystatechange = null;
                                a()
                            }
                        }
                    } else {
                        b.onload = a
                    }
                }
                c.appendChild(b)
            };
            loadJs("http://changyan.sohu.com/upload/changyan.js", function () {
                window.changyan.api.config({
                    appid: appid,
                    conf: conf
                })
            });
        }
    })();
</script>








<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 <script src="/js/is.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/elevator.js"></script>
  </div>
</body>
</html>