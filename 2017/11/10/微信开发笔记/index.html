<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>微信开发笔记 | MARTIST</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="：-}">
<meta name="keywords" content="php">
<meta property="og:type" content="article">
<meta property="og:title" content="微信开发笔记">
<meta property="og:url" content="http://martist.cn/2017/11/10/微信开发笔记/index.html">
<meta property="og:site_name" content="MARTIST">
<meta property="og:description" content="：-}">
<meta property="og:locale" content="简体中文">
<meta property="og:image" content="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx4.png">
<meta property="og:updated_time" content="2017-11-17T07:32:33.758Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="微信开发笔记">
<meta name="twitter:description" content="：-}">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx1.png">
  
    <link rel="alternate" href="/atom.xml" title="MARTIST" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://martist.cn"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/2012/01/01/About Me/">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">MARTIST</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-微信开发笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/10/微信开发笔记/" class="article-date">
  <time datetime="2017-11-09T16:00:00.000Z" itemprop="datePublished">2017-11-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      微信开发笔记
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>：-} <a id="more"></a></p>
<h1 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h1><h2 id="laravel-5-5-20框架"><a href="#laravel-5-5-20框架" class="headerlink" title="laravel 5.5.20框架"></a>laravel 5.5.20框架</h2><p>可以用artisan命令查看框架版本：</p>
<pre><code>php artisan -V
</code></pre><p><img src="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx1.png" alt=""></p>
<h2 id="composer组件easywechat"><a href="#composer组件easywechat" class="headerlink" title="composer组件easywechat"></a>composer组件easywechat</h2><p>此处要注意版本，我用的是3.0，组件版本不确定会坑。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">composer require &quot;overtrue/laravel-wechat:~3.0&quot;</div></pre></td></tr></table></figure>
<p>在laravel中配置：</p>
<p>注册 ServiceProvider:</p>
<p>Overtrue\LaravelWechat\ServiceProvider::class,</p>
<pre><code>创建配置文件：
</code></pre><p>php artisan vendor:publish –provider=”Overtrue\LaravelWechat\ServiceProvider”</p>
<pre><code>请修改应用根目录下的 config/wechat.php 中对应的项即可；

（可选）添加外观到 config/app.php 中的 aliases 部分:
</code></pre><p>‘EasyWeChat’ =&gt; Overtrue\LaravelWechat\Facade::class,</p>
<p>参考：<a href="https://github.com/overtrue/laravel-wechat/tree/3.1.10" target="_blank" rel="external">GitHub - overtrue/laravel-wechat at 3.1.10</a> 配置OAuth 中间件部分。</p>
<h2 id="vagrant-homestead运行环境"><a href="#vagrant-homestead运行环境" class="headerlink" title="vagrant - homestead运行环境"></a>vagrant - homestead运行环境</h2><h3 id="Homestead-yaml文件部分配置"><a href="#Homestead-yaml文件部分配置" class="headerlink" title="Homestead.yaml文件部分配置"></a>Homestead.yaml文件部分配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">ip: &quot;192.168.10.10&quot;</div><div class="line">memory: 2048</div><div class="line">cpus: 1</div><div class="line">provider: virtualbox</div><div class="line"></div><div class="line">authorize: ~/.ssh/id_rsa.pub</div><div class="line"></div><div class="line">keys:</div><div class="line">- ~/.ssh/id_rsa</div><div class="line"></div><div class="line">folders:</div><div class="line">- map: /Users/machuang/Code</div><div class="line">to: /home/vagrant/Code</div><div class="line"></div><div class="line">sites:</div><div class="line"># - map: homestead.app</div><div class="line">#   to: /home/vagrant/Code</div><div class="line"># - map: paper.app</div><div class="line">#   to: /home/vagrant/Code/paper/public</div><div class="line">- map: test.app</div><div class="line">to: /home/vagrant/Code/laravel/public</div></pre></td></tr></table></figure>
<h2 id="内网穿透工具-ngrok"><a href="#内网穿透工具-ngrok" class="headerlink" title="内网穿透工具-ngrok"></a>内网穿透工具-ngrok</h2><p>作为一个Web开发者，我们有时候会需要临时地将一个本地的Web网站部署到外网，以供他人体验评价或协助调试等等，通常我们会这么做：</p>
<pre><code>找到一台运行于外网的Web服务器
服务器上有网站所需要的环境，否则自行搭建
将网站部署到服务器上
调试结束后，再将网站从服务器上删除
</code></pre><p>只不过是想向朋友展示一下网站而已，要不要这么麻烦,使用ngrok，免费的服务就足够实现将一个本地的Web网站临时部署到外网了。</p>
<p><img src="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx2.png" alt=""></p>
<h3 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h3><p><a href="https://ngrok.com/" target="_blank" rel="external">ngrok</a></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p> <a href="https://tenten.co/blog/how-to-use-ngrok-to-connect-your-localhost/" target="_blank" rel="external">怎麼將內網的 localhost 讓外面的人都看得到呢？用用 ngrok 吧！ - Startup Incubator Asia</a></p>
<p>去官网下载下来，然后解压，当前目录的 ./ngrok文件就是启动文件了，</p>
<p>我在/etc/profile 写了下别名，来简化操作</p>
<pre><code>alias ngrok=&apos;/Users/machuang/Desktop/ngrok&apos;
</code></pre><p>免费的注册，激活ngrok<br><a href="https://dashboard.ngrok.com/get-started" target="_blank" rel="external">ngrok - secure introspectable tunnels to localhost</a></p>
<p>根据官网页面给的命令去激活你的ngrok。</p>
<p>好，回到页面来启动它，映射到我的homestead虚拟机的ip和端口号。命令：</p>
<pre><code>ngrok http 192.168.10.10:80
</code></pre><p>如果没有报错,说明运行正常,这个时候,终端会出现下面的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Session Status                online                                            </div><div class="line">Account                       马 闯  (Plan: Free)                               </div><div class="line">Version                       2.2.8                                             </div><div class="line">Region                        United States (us)                                </div><div class="line">Web Interface                 http://127.0.0.1:4040                             </div><div class="line">Forwarding                    http://c7971ad2.ngrok.io -&gt; 192.168.10.10:80      </div><div class="line">Forwarding                    https://c7971ad2.ngrok.io -&gt; 192.168.10.10:80     </div><div class="line">                                                                                </div><div class="line">Connections                   ttl     opn     rt1     rt5     p50     p90       </div><div class="line">                              138     0       0.00    0.00    3.47    66.13     </div><div class="line">                                                                                </div><div class="line">HTTP Requests                                                                   </div><div class="line">-------------                                                                   </div><div class="line">                                                                                </div><div class="line">GET  /userInfo                 200 OK                                           </div><div class="line">POST /wechat                   200 OK                                           </div><div class="line">POST /wechat                   200 OK</div></pre></td></tr></table></figure>
<p>3、 浏览器打开 Web入口<a href="http://127.0.0.1:4040" target="_blank" rel="external">http://127.0.0.1:4040</a>.  页面上面查看到当前访问的请求细节.</p>
<h2 id="微信公众平台测试账号申请"><a href="#微信公众平台测试账号申请" class="headerlink" title="微信公众平台测试账号申请"></a>微信公众平台测试账号申请</h2><p>微信公众平测试号申请地址：<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index" target="_blank" rel="external">微信公众平台</a></p>
<p>需要配置的地方</p>
<p><img src="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx3.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/ma1203580780/ma1203580780.github.io/master/images/wx4.png" alt=""></p>
<p>laravel以外的用法参考：</p>
<p><a href="http://www.thinkphp.cn/code/3553.html" target="_blank" rel="external">Thinkphp5和EasyWeChat进行网页授权登录 - ThinkPHP框架</a></p>
<h1 id="👌，开发"><a href="#👌，开发" class="headerlink" title="👌，开发"></a>👌，开发</h1><h2 id="定义路由"><a href="#定义路由" class="headerlink" title="定义路由"></a>定义路由</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;?php</div><div class="line"></div><div class="line">Route::any(&apos;/wechat&apos;, &apos;WeChatController@serve&apos;);</div><div class="line"></div><div class="line">Route::get(&apos;/users&apos;, &apos;WeChatController@users&apos;);</div><div class="line"></div><div class="line">Route::get(&apos;/menu&apos;, &apos;WeChatController@menu&apos;);</div><div class="line"></div><div class="line">Route::get(&apos;/addMenu&apos;, &apos;WeChatController@addMenu&apos;);</div></pre></td></tr></table></figure>
<h2 id="处理微信的请求消息"><a href="#处理微信的请求消息" class="headerlink" title="处理微信的请求消息"></a>处理微信的请求消息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">/**</div><div class="line"> * User: maChuang</div><div class="line"> * blog: martist.cn</div><div class="line"> * Date: 2017/11/8</div><div class="line"> * Time: 下午5:42</div><div class="line"> */</div><div class="line"></div><div class="line">namespace App\Http\Controllers;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">use EasyWeChat\Foundation\Application;</div><div class="line"></div><div class="line">class WeChatController extends Controller</div><div class="line">&#123;</div><div class="line">    public $wechat;</div><div class="line"></div><div class="line">    public function __construct(Application $wechat)</div><div class="line">    &#123;</div><div class="line">        $this-&gt;wechat = $wechat;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 处理微信的请求消息</div><div class="line">     *</div><div class="line">     * @return string</div><div class="line">     */</div><div class="line">    public function serve()</div><div class="line">    &#123;</div><div class="line">        $wechat = app(&apos;wechat&apos;);</div><div class="line">//        $wechat-&gt;server-&gt;setMessageHandler(function($message)&#123;</div><div class="line">//            return &quot;wocou!!!！&quot;;</div><div class="line">//        &#125;);</div><div class="line">        $userApi = $wechat-&gt;user;</div><div class="line">        $wechat-&gt;server-&gt;setMessageHandler(function ($message) use ($userApi) &#123;</div><div class="line">            switch ($message-&gt;MsgType) &#123;</div><div class="line">                case &apos;event&apos;:</div><div class="line">                    return &apos;收到事件消息&apos;;</div><div class="line">                    break;</div><div class="line">                case &apos;text&apos;:</div><div class="line">                    return $userApi-&gt;get($message-&gt;FromUserName)-&gt;headimgurl;</div><div class="line">                    break;</div><div class="line">                case &apos;image&apos;:</div><div class="line">                    return &apos;收到图片消息&apos;;</div><div class="line">                    break;</div><div class="line">                case &apos;voice&apos;:</div><div class="line">                    return &apos;收到语音消息&apos;;</div><div class="line">                    break;</div><div class="line">                case &apos;video&apos;:</div><div class="line">                    return &apos;收到视频消息&apos;;</div><div class="line">                    break;</div><div class="line">                case &apos;location&apos;:</div><div class="line">                    return &apos;收到坐标消息&apos;;</div><div class="line">                    break;</div><div class="line">                case &apos;link&apos;:</div><div class="line">                    return &apos;收到链接消息&apos;;</div><div class="line">                    break;</div><div class="line">                // ... 其它消息</div><div class="line">                default:</div><div class="line">                    return &apos;收到其它消息&apos;;</div><div class="line">                    break;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        return $wechat-&gt;server-&gt;serve();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * User: maChuang</div><div class="line">     * @return \EasyWeChat\Support\Collection</div><div class="line">     * 当前公众号的关注者列表</div><div class="line">     */</div><div class="line">    public function users()</div><div class="line">    &#123;</div><div class="line">        return $this-&gt;wechat-&gt;user-&gt;lists();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /**</div><div class="line">     * User: maChuang</div><div class="line">     * 展示菜单</div><div class="line">     */</div><div class="line">    public function menu()</div><div class="line">    &#123;</div><div class="line">        $app = $this-&gt;wechat;</div><div class="line">        $menu = $app-&gt;menu;</div><div class="line">        $menus = $menu-&gt;all();</div><div class="line">        dd($menus);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * User: maChuang</div><div class="line">     * @return \EasyWeChat\Support\Collection</div><div class="line">     * 添加菜单</div><div class="line">     */</div><div class="line">    public function addMenu()</div><div class="line">    &#123;</div><div class="line">        $app = $this-&gt;wechat;</div><div class="line">        $menu = $app-&gt;menu;</div><div class="line">        $buttons = [</div><div class="line">            [</div><div class="line">                &quot;type&quot; =&gt; &quot;view&quot;,</div><div class="line">                &quot;name&quot; =&gt; &quot;授权&quot;,</div><div class="line">                &quot;url&quot;  =&gt; &quot;http://c7971ad2.ngrok.io/scopes&quot;</div><div class="line">            ],</div><div class="line">            [</div><div class="line">                &quot;name&quot;       =&gt; &quot;二级菜单&quot;,</div><div class="line">                &quot;sub_button&quot; =&gt; [</div><div class="line">                    [</div><div class="line">                        &quot;type&quot; =&gt; &quot;view&quot;,</div><div class="line">                        &quot;name&quot; =&gt; &quot;我的信息&quot;,</div><div class="line">                        &quot;url&quot;  =&gt; &quot;http://c7971ad2.ngrok.io/userInfo&quot;,</div><div class="line">                    ],</div><div class="line">                    [</div><div class="line">                        &quot;type&quot; =&gt; &quot;view&quot;,</div><div class="line">                        &quot;name&quot; =&gt; &quot;大大大&quot;,</div><div class="line">                        &quot;url&quot;  =&gt; &quot;http://c7971ad2.ngrok.io/large&quot;,</div><div class="line">                    ],</div><div class="line">                    [</div><div class="line">                        &quot;type&quot; =&gt; &quot;click&quot;,</div><div class="line">                        &quot;name&quot; =&gt; &quot;小小小&quot;,</div><div class="line">                        &quot;key&quot; =&gt; &quot;ASDZFE&quot;</div><div class="line">                    ],</div><div class="line">                ],</div><div class="line">            ],</div><div class="line">        ];</div><div class="line">        $res = $menu-&gt;add($buttons);</div><div class="line">        return $res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此时，你可以在公众号发现添加自定义菜单，查看菜单，查看公众号关注者，回复信息等功能已经简单的实现了。</p>
<h2 id="获取用户的openid和微信信息"><a href="#获取用户的openid和微信信息" class="headerlink" title="获取用户的openid和微信信息"></a>获取用户的openid和微信信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Route::group([&apos;middleware&apos; =&gt; [&apos;wechat.oauth&apos;]], function () &#123;</div><div class="line"></div><div class="line">    Route::get(&apos;/userInfo&apos;, function () &#123;</div><div class="line">        $user = session(&apos;wechat.oauth_user&apos;); // 拿到授权用户资料</div><div class="line">        dd($user);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="返回结果"><a href="#返回结果" class="headerlink" title="返回结果"></a>返回结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;subscribe&quot;: 1,</div><div class="line">    &quot;openid&quot;: &quot;oCf0jw4DhUXmv6ZhITtBRFn3yLM4&quot;,</div><div class="line">    &quot;nickname&quot;: &quot;🎗martist.cn马闯🎗&quot;,</div><div class="line">    &quot;sex&quot;: 1,</div><div class="line">    &quot;language&quot;: &quot;zh_CN&quot;,</div><div class="line">    &quot;city&quot;: &quot;石家庄&quot;,</div><div class="line">    &quot;province&quot;: &quot;河北&quot;,</div><div class="line">    &quot;country&quot;: &quot;中国&quot;,</div><div class="line">    &quot;headimgurl&quot;: &quot;http://wx.qlogo.cn/mmopen/9VvH5ZWanZUKiaGbMrMsWeyl1E4yFWJCic5iblA5FSyVcYSPjkUElLsHO697rFgv81DibzNjeVicpTUEruEg3Nbfn7YTDWoquz78f/0&quot;,</div><div class="line">    &quot;subscribe_time&quot;: 1510198660,</div><div class="line">    &quot;remark&quot;: &quot;&quot;,</div><div class="line">    &quot;groupid&quot;: 0,</div><div class="line">    &quot;tagid_list&quot;: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>其他操作可以具体参见微信公众号官方文档，我在做微信开发和微信支付都是基于eastWeChat这个组件完成的，节省了很多时间。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://martist.cn/2017/11/10/微信开发笔记/" data-id="cjg20644y006jbd2nn2g55fgr" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>

    </footer>
  </div>
  
    
    
<nav id="article-nav">
  
    <a href="/2017/11/11/laravel使用多个数据库连接/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          laravel使用多个数据库连接
        
      </div>
    </a>
  
  
    <a href="/2017/11/07/记一次部署node项目到centos服务器经历/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">记一次部署node项目到centos服务器经历</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
            <div id="SOHUCS" sid="2017/11/10/微信开发笔记/"> </div>
    
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#开发环境"><span class="toc-number">1.</span> <span class="toc-text">开发环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#laravel-5-5-20框架"><span class="toc-number">1.1.</span> <span class="toc-text">laravel 5.5.20框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#composer组件easywechat"><span class="toc-number">1.2.</span> <span class="toc-text">composer组件easywechat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vagrant-homestead运行环境"><span class="toc-number">1.3.</span> <span class="toc-text">vagrant - homestead运行环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Homestead-yaml文件部分配置"><span class="toc-number">1.3.1.</span> <span class="toc-text">Homestead.yaml文件部分配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#内网穿透工具-ngrok"><span class="toc-number">1.4.</span> <span class="toc-text">内网穿透工具-ngrok</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#官网"><span class="toc-number">1.4.1.</span> <span class="toc-text">官网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考"><span class="toc-number">1.4.2.</span> <span class="toc-text">参考</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#微信公众平台测试账号申请"><span class="toc-number">1.5.</span> <span class="toc-text">微信公众平台测试账号申请</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#👌，开发"><span class="toc-number">2.</span> <span class="toc-text">👌，开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#定义路由"><span class="toc-number">2.1.</span> <span class="toc-text">定义路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#处理微信的请求消息"><span class="toc-number">2.2.</span> <span class="toc-text">处理微信的请求消息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取用户的openid和微信信息"><span class="toc-number">2.3.</span> <span class="toc-text">获取用户的openid和微信信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#返回结果"><span class="toc-number">2.3.1.</span> <span class="toc-text">返回结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">2.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2018 martist.cn&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;marteeet@gmail.com
    </div>
  </div>
</footer>
 <script src="/jquery/jquery.min.js"></script>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/2012/01/01/About Me/" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      



<script type="text/javascript ">
    (function () {
        var appid = 'cytf1deXv';
        var conf = '6867419241543404b6c287f39f49f3ca';
        var width = window.innerWidth || document.documentElement.clientWidth;
        if (width < 960) {
            window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>');
        } else {
            var loadJs = function (d, a) {
                var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
                var b = document.createElement("script");
                b.setAttribute("type", "text/javascript");
                b.setAttribute("charset", "UTF-8");
                b.setAttribute("src", d);
                if (typeof a === "function") {
                    if (window.attachEvent) {
                        b.onreadystatechange = function () {
                            var e = b.readyState;
                            if (e === "loaded" || e === "complete") {
                                b.onreadystatechange = null;
                                a()
                            }
                        }
                    } else {
                        b.onload = a
                    }
                }
                c.appendChild(b)
            };
            loadJs("http://changyan.sohu.com/upload/changyan.js", function () {
                window.changyan.api.config({
                    appid: appid,
                    conf: conf
                })
            });
        }
    })();
</script>








<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 <script src="/js/is.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/elevator.js"></script>
  </div>
</body>
</html>